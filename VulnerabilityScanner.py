import PortScanner

targets_ip = input("[+] Enter Targets to scan for Vulnerable open ports: ")
port_no = int(input("[+] Enter Amount of ports you want to Scan (500-first 500 ports):"))
vul_file = input('[+] Enter the path to the file with Vulnerable software: ')
print('\n')

targetObj = PortScanner.PortScan(targets_ip, port_no)
targetObj.scan()

with open(vul_file, 'r') as file:
    count = 0
    for banner in targetObj.banners:
        file.seek(0)
        for line in file.readlines():
            if line.strip() in banner:
                print('[!!] VULNERABLE BANNER: ' + banner + " ON PORT: " + str(targetObj.open_ports[count]))
        count += 1
